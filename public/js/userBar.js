define(["jquery","underscore"],function(a,b){console.log("userBar loaded");var c=a(".tb-search-form"),d=a(".tb-search-input"),e=a(".icon-loading"),f=a(".icon-clear"),g=a(".search-result");return d.on("focus",function(){c.css({background:"#FFF"})}).on("keydown",function(){a.ajax("/takeaway/public/index.php/userBarSearch",{beforeSend:function(){f.addClass("hide"),e.removeClass("hide")},success:function(c){if("true"==c.success){var d=c.data,h=b.template(a("#tpl-tb-search").html())({data:d});g.html(h).show(),e.addClass("hide"),f.removeClass("hide")}else alert(123)}}),f.on("click",function(){c.css({background:""}),g.hide(),e.addClass("hide"),f.addClass("hide"),d.val("")})}),a(".icon-cart").on("click",function(){return"block"==a(".tb-cart-dropdown-wrapper").css("display")?a(".tb-cart-dropdown-wrapper").hide():void a.ajax("/takeaway/public/index.php/userBarCart",{beforeSend:function(){a(".tb-cart-dropdown-wrapper").show(),a(".tb-msg-dropdown-wrapper").hide(),a(".tb-user-dropdown").hide(),f.click()},success:function(c){var d,e=c.data;d=c&&"true"==c.success&&0!==e.goods.length?b.template(a("#tpl-tb-cart").html())({data:e}):b.template(a("#tpl-tb-cart-empty").html())(),a(".tb-cart-dropdown").html(d)},error:function(){var c=b.template(a("#tpl-tb-cart-empty").html())();a(".tb-cart-dropdown").html(c)}})}),a(".icon-msg").on("click",function(){return"block"==a(".tb-msg-dropdown-wrapper").css("display")?a(".tb-msg-dropdown-wrapper").hide():void a.ajax("/takeaway/public/index.php/userBarMsg",{beforeSend:function(){a(".tb-msg-dropdown-wrapper").show(),a(".tb-cart-dropdown-wrapper").hide(),a(".tb-user-dropdown").hide(),f.click()},success:function(c){if("true"==c.success){var d,e=c.data;d=(e.goods&&e.goods.length,b.template(a("#tpl-tb-msg-empty").html())()),a(".tb-msg-dropdown").html(d)}},error:function(){var c=b.template(a("#tpl-tb-msg-empty").html())();a(".tb-msg-dropdown").html(c)}})}),a(".tb-username").on("click",function(){return"block"==a(".tb-user-dropdown").css("display")?a(".tb-user-dropdown").hide():(a(".tb-cart-dropdown-wrapper").hide(),a(".tb-msg-dropdown-wrapper").hide(),f.click(),void a(".tb-user-dropdown").show())}),{}});